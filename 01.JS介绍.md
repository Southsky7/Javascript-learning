# 1.JavaScript介绍

- 完整的JS包含3个部分
  - 核心ECMAScript，由ECMA-262定义并提供核心功能
  - 文档对象模型DOM，提供与网页内容交互的方法和接口
  - 浏览器对象模型BOM，提供与浏览器交互的方法和接口

#### ECMAScript

- 即ECMA-262定义的语言，不局限于Web浏览器，Web浏览器只是ECMAScript实现可能存在的一种宿主环境，宿主环境提供ECMAScript的基准实现和与环境自身交互必须的扩展。扩展(如DOM)使用ECAMScript核心类型与语法，提供特定于环境的额外功能。其他宿主环境还有服务器端JS平台Node.js和被淘汰的Adobe Flash
- ECMAScript符合性:
  - 支持ECMA-262中描述的所有'类型、值、对象、属性、函数及程序语法与语义'
  - 支持Unicode字符标准
  - 增加ECMA-262中未提及的'额外的类型、值、对象、属性和函数'，ECMA-262所说的额外内容主要指规范中未给出的新对象或对象的新属性
  - 支持ECMA-262中未定义的'程序和正则表达式语法'，即允许修改和扩展内置的正则表达式特性
  - 以上条件为实现开发者基于ECMAScript开发语言提供了极大的权限和灵活度，也是其广受欢迎的原因之一。

#### DOM

- 文档对象模型，Document Object Model,是一个应用编程接口API,用于在HTML中使用扩展的XML，DOM将整个页面抽象为一组分层节点，HTML或XML页面的每个组成部分都是一种节点，包含不同的数据。
- DOM通过创建表示文档的树，让开发者随心所欲的控制网页的内容和结构，使用DOM API，可以随心所欲的删除、添加、替换、修改节点。

#### BOM

- Browser Object Model,浏览器对象模型，用于支持访问和操作浏览器的窗口，使用BOM，开发者可以操控浏览器显示页面之外的部分。HTML5规范了BOM
- BOM主要针对浏览器窗口和子窗口(frame),不过人通常把任何特定于浏览器的扩展归于BOM，如:
  - 弹出新浏览器窗口的能力
  - 移动、缩放和关闭浏览器窗口的功能
  - navigator对象，提供关于浏览器的详细信息
  - location对象，提供浏览器加载页面的详尽信息。
  - screen对象，提供关于用户屏幕分辨率的详尽信息
  - performance对象，提供浏览器内存占用、导航行为和时间统计的信息
  - 对cookie的支持

### < script>

- 将JS插入HTML的主要方法是使用< script>元素，其具有8个属性

  - async:可选，表示应立即开始下载脚本，但不能阻止其他页面动作，如下载资源或等待脚本下载。仅对外部脚本有效。
  - charset:可选，指定代码字符集，很少用，大多数浏览器不在乎它的值
  - crossorigin:可选，配置相关请求的CROS(跨源资源共享)设置，默认不使用CORS.crossorigin='anonymous':配置文件请求不必设置凭据标志。crossorigin='use-credentials':设置凭据标志，意味着出站请求包含凭据。
  - defer:可选，表示脚本可延迟到文档完全被解析和显示后再执行，仅对外部文件有效。
  - integrity:可选，允许比对接收到的资源和指定的加密签名以验证子资源完整性(SRI,Subresource Integrity),若接收到的资源签名与此属性指定的签名不匹配则报错。此属性用于确保内容分发网络(CDN,Content Delivery Network)不好提供恶意内容
  - language:废弃
  - src:可选，指定外部文件地址
  - type:可选，代替language表示代码块中脚本语言的类型(即MIME类型)，按照惯例这个值始终是type = text/javascript

- 使用< script>有两种方式:通过它直接在网页中嵌入JS代码和通过它包含外部JS文件(src=)

- < script>内的代码会从上到下解释，在< script>内的代码被计算完成之前，页面其余内容不会被加载和显示。(即< script>拥有最高优先级)，因此通常把< script>放到页面末尾，介于主内容之后及< /body>之前。

- 使用行内JS代码时，注意当需要使用字符串< script>时，使用转义字符 ' \ '   以避免歧义。

  ```javascript
  <body>
      <script  type="text/javascript">
      console.log('<\/script>')  
      </script>
  </body>
  ```

- 解释外部js文件时页面会阻塞(阻塞时间也包括下载文件时间)

- 使用了src属性的< script>元素不应该在标签中再包含其他js代码，否则浏览器会只下载执行脚本文件而忽略行内代码。

- 不管包含什么代码，浏览器都按照< script>在页面中出现的顺序依次解释它们，前提是它们没有使用defer和async属性。

- 过去，所有< script>标签都放在< head>标签内，目的是将外部的CSS和JS文件集中到一起，但这也意味着必须把所有JS代码下载解析解释完成后，才能开始渲染页面(页面在浏览器解析到< body>时开始渲染)，此期间浏览器窗口完全空白，因此现在把JS放在< body>标签内,这样页面会在处理js代码前完全渲染页面，用户感觉页面加载更快。

```javascript
</head>
<body>
    <script  type="text/javascript">
    </script>
</body>
```

#### 异步执行脚本async:

- 标记为async的脚本不能保证按照它们出现的次序执行，给脚本添加async属性目的是告诉浏览器不必等脚本下载和执行完毕再加载页面，也不必等到该异步脚本下载和执行后再加载其他脚本，因此异步脚本不应该在加载期间修改DOM。
- 异步脚本会在页面load事件前执行，但可能在DOMContentLoaded之前或之后
- 好的Web开发实践不推荐使用异步脚本

#### type属性

- 所有浏览器将JS作为默认的编程语言，type属性使用MIMIE类型字符串来标识< script>内容，但MIME类型未跨浏览器标准化，即使浏览器默认使用JS，某些情况下也可能导致浏览器跳过相关代码，因此除非使用XHTML或要求< script>包含非JS代码，最佳做法是不指定type属性。

#### 行内代码与外部文件

- 尽量将JS代码放在外部文件中，优点如下
  - 可维护性:JS代码若分布到很多HTML页面会导致维护困难，用一个目录保存所有JS文件更容易维护。
  - 缓存:浏览器会根据特定的设置缓存所有外部链接的JS文件，意味着若两个页面用到同一个文件，只需下载依一次。
  - 适应未来:JS放到外部文件就不需要考虑XHTML或注释黑科技等。

#### 文档模式:

- IE5.5发明了文档模式的概念，可用doctype切换文档模式，最初文档模式有两种:混杂模式(quirks mode)和标准模式(standards mode)，主要区别只体现在通过CSS渲染的内容方面，但对JS也有些关联影响，称为副作用。
- 随后出现了第三种模式，准标准模式(almost standards mode)，此模式下的浏览器支持很多标准的特性但没那么严格，主要区别在于如何对待图片元素周围的空白。
- 准标准模式和标准模式非常接近，很少需要区分，通常所说的标准模式指混杂模式以外的模式。